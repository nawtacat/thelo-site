<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="title">thelo</title>
    <link rel="icon" href="https://thelo.space/img/thelofavicon.png" type="image/png" />
    <link rel="apple-touch-icon" href="https://thelo.space/img/yarnicon.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome is kept for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

   <style>
    /*
      ============================================
      RESET & VARIABLES (Simulating Tailwind Base)
      ============================================
    */
    :root {
        /* Core Brand Colors */
        --thelo-blue: #2563EB;
        --thelo-bg: #F8F9FA;
        --thelo-text: #111827;
        --grid-color: #E5E7EB;

        /* Tailwind Slate Palette Approximation */
        --slate-100: #f1f5f9;
        --slate-200: #e2e8f0;
        --slate-300: #cbd5e1;
        --slate-500: #64748b;
        --slate-600: #475569;
        --slate-800: #1e293b;
        
        --white: #ffffff;
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        border-width: 0;
        border-style: solid;
        border-color: var(--slate-200);
    }

    html { scroll-behavior: smooth; }

    body {
        font-family: 'Montserrat Arm', 'Manrope', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
        background-color: var(--thelo-bg);
        color: var(--thelo-text);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        line-height: 1.5;
        
        /* Background Grid Pattern */
        background-image:
            linear-gradient(to right, var(--grid-color) 1px, transparent 1px),
            linear-gradient(to bottom, var(--grid-color) 1px, transparent 1px);
        background-size: 40px 40px;
    }

    img {
        max-width: 100%;
        height: auto;
        display: block;
    }

    a {
        text-decoration: none;
        color: inherit;
    }

    ul { list-style: none; }

    button {
        background: transparent;
        cursor: pointer;
    }

    /* Typography Utilities */
    h1, h2, h3, h4, h5, h6 { font-weight: 800; line-height: 1.1; }
    .font-bold { font-weight: 700; }
    .font-semibold { font-weight: 600; }
    .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
    .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
    .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
    
    /*
      ============================================
      CUSTOM FONTS (Armenian)
      ============================================
    */
    @font-face {
      font-family: 'Montserrat Arm';
      src: url('https://thelo.space/fonts/Montserratarm-Regular.otf') format('opentype');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
      unicode-range: U+0530-058F, U+FB13-FB17;
    }
    @font-face {
      font-family: 'Montserrat Arm';
      src: url('https://thelo.space/fonts/Montserratarm-SemiBold.otf') format('opentype');
      font-weight: 600;
      font-style: normal;
      font-display: swap;
      unicode-range: U+0530-058F, U+FB13-FB17;
    }
    @font-face {
      font-family: 'Montserrat Arm';
      src: url('https://thelo.space/fonts/Montserratarm-ExtraBold.otf') format('opentype');
      font-weight: 800;
      font-style: normal;
      font-display: swap;
      unicode-range: U+0530-058F, U+FB13-FB17;
    }

    /*
      ============================================
      LAYOUT UTILITIES
      ============================================
    */
    .container-max {
        max-width: 80rem; /* 7xl */
        margin-left: auto;
        margin-right: auto;
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }

    @media (min-width: 1024px) {
        .container-max {
            padding-left: 2rem;
            padding-right: 2rem;
        }
    }

    .container-narrow {
        max-width: 56rem; /* 4xl */
        margin-left: auto;
        margin-right: auto;
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }

    /*
      ============================================
      NAVIGATION
      ============================================
    */
    #mainNav {
        width: 100%;
        z-index: 40;
        position: relative;
        margin-top: 0.5rem; /* Reduced margin to move it up slightly */
    }

    .nav-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding-top: 1.5rem;
        padding-bottom: 1.5rem;
        position: relative;
    }

    .logo img {
        height: 3rem; /* Slightly increased logo size again */
        width: auto;
    }

    .nav-links-desktop {
        display: none; /* Keep hidden for mobile by default */
        /* For desktop, it will be displayed by the media query below */
        margin: 0 auto; /* Center the links */
    }

    .nav-links-desktop ul {
        display: flex;
        gap: 1.5rem;
    }

    .nav-link {
        color: var(--thelo-text);
        transition: color 0.2s;
    }

    .nav-link:hover {
        color: var(--thelo-blue);
    }

    .nav-controls {
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .lang-switcher {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
    }
    
    .lang-btn {
        cursor: pointer;
        font-weight: 600;
        opacity: 0.6;
    }
    
    .lang-btn:hover { opacity: 1; }
    
    /* Utility classes manipulated by JS */
    .opacity-100 { opacity: 1 !important; }
    .opacity-60 { opacity: 0.6 !important; }
    
    .divider { color: var(--slate-300); }

    .mobile-menu-btn {
        border-radius: 0.375rem;
        padding: 0.5rem;
        color: var(--slate-600);
    }
    
    .mobile-menu-btn:hover { background-color: var(--slate-100); }
    .mobile-menu-btn:focus { outline: 2px solid rgba(37, 99, 235, 0.5); }
    .mobile-menu-btn svg { height: 1.5rem; width: 1.5rem; stroke: currentColor; }

    /* Mobile Menu Dropdown */
    #mobileMenu {
        display: none; /* Hidden by default */
    }
    
    #mobileMenu.hidden { display: none; }
    #mobileMenu:not(.hidden) { display: block; }

    #mobileMenu ul {
        background-color: var(--white);
        border-top: 1px solid var(--slate-200);
        padding: 0.5rem 1rem 1rem 1rem;
    }
    
    #mobileMenu a {
        display: block;
        padding-top: 0.5rem;
        padding-bottom: 0.5rem;
    }

   @media (min-width: 768px) {
    .nav-links-desktop { 
        display: flex; 
        /* Ensure alignment for desktop layout */
        align-items: center; 
    }
    .mobile-menu-btn, #mobileMenu { display: none !important; }
}

    /*
      ============================================
      HERO SECTION
      ============================================
    */
    header {
        position: relative;
        padding-top: 8rem; /* 32 */
        padding-bottom: 6rem; /* 24 */
    }

    @media (min-width: 1024px) {
        header {
            padding-top: 10rem; /* 40 */
            padding-bottom: 8rem; /* 32 */
        }
    }

    .hero-grid {
        display: grid;
        grid-template-columns: 1fr;
        max-width: 42rem; /* 2xl */
    }
    
    @media (min-width: 1024px) {
        .hero-grid { max-width: 32rem; /* lg */ }
    }

    .hero-text-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .hero-title {
        font-size: 3rem; /* 5xl */
        letter-spacing: -0.05em;
        color: var(--thelo-text);
    }

    .text-blue-highlight { color: var(--thelo-blue); }

    @media (min-width: 768px) { .hero-title { font-size: 3.75rem; /* 6xl */ } }
    @media (min-width: 1024px) { .hero-title { font-size: 4.5rem; /* 7xl */ } }

    /* Hero Image Positioning */
    .hero-img-container {
        margin-top: 3rem;
        margin-right: -1.5rem;
        transition-delay: 0.3s;
    }

    @media (min-width: 1024px) {
        .hero-img-container {
            margin-right: 0;
            margin-top: 0;
            position: absolute;
            bottom: -3rem;
            right: 0;
            width: 40%;
        }
    }

    /*
      ============================================
      TEXT SECTIONS
      ============================================
    */
    .text-section {
        padding-top: 8rem;
        padding-bottom: 6rem;
    }
    @media (min-width: 640px) { .text-section { padding-bottom: 8rem; } }

    .text-content-wrapper {
        text-align: left;
        max-width: 48rem; /* 3xl */
        margin-left: auto;
        margin-right: auto;
    }
    
    .text-slate-600 { color: var(--slate-600); }
    .mt-4 { margin-top: 1rem; }

    /*
      ============================================
      "WHY" SECTION (Grid Features)
      ============================================
    */
    .section-padding {
        padding-top: 6rem;
        padding-bottom: 6rem;
    }
    @media (min-width: 640px) { .section-padding { padding-top: 8rem; padding-bottom: 8rem; } }

    .section-header {
        max-width: 48rem;
        margin-left: auto;
        margin-right: auto;
        text-align: center;
    }

    .section-title {
        font-size: 2.25rem; /* 4xl */
        color: var(--thelo-text);
    }
    @media (min-width: 640px) { .section-title { font-size: 3rem; /* 5xl */ } }

    .window-container {
        position: relative;
        background-color: white;
        border: 1px solid var(--grid-color);
        border-radius: 0.75rem;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        padding: 2.5rem;
        margin-top: 4rem;
        transition-delay: 0.2s;
    }

    .window-container::before {
        content: ' ';
        position: absolute;
        top: 1rem;
        left: 1rem;
        width: 52px;
        height: 12px;
        background-image: url("data:image/svg+xml,%3Csvg width='52' height='12' viewBox='0 0 52 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='6' cy='6' r='6' fill='%23FF5F56'/%3E%3Ccircle cx='26' cy='6' r='6' fill='%23FFBD2E'/%3E%3Ccircle cx='46' cy='6' r='6' fill='%2327C93F'/%3E%3C/svg%3E%0A");
        background-repeat: no-repeat;
    }

    .feature-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 3rem; /* 12 */
        text-align: center;
        padding-top: 2rem;
    }

    @media (min-width: 768px) {
        .feature-grid {
            grid-template-columns: repeat(3, 1fr);
            text-align: left;
        }
    }

    .mt-2 { margin-top: 0.5rem; }

    /*
      ============================================
      THELOPAD SECTION
      ============================================
    */
    .split-layout {
        display: grid;
        grid-template-columns: 1fr;
        gap: 2.5rem; /* gap-y-10 */
    }

    @media (min-width: 1024px) {
        .split-layout {
            grid-template-columns: repeat(2, 1fr);
            column-gap: 4rem; /* gap-x-16 */
        }
    }

    .pill-tag {
        margin-top: 1rem;
        display: inline-block;
        border-radius: 9999px;
        background-color: var(--thelo-blue);
        padding: 0.375rem 1rem;
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--white);
        width: fit-content;
    }

    .mt-8 { margin-top: 2rem; }

    /*
      ============================================
      CANVAS REPLAY SECTION
      ============================================
    */
    #drawing-replay {
        display: none;
        padding-top: 6rem;
        padding-bottom: 4rem;
    }

    @media (min-width: 640px) {
        #drawing-replay {
            display: block;
            padding-top: 8rem;
            padding-bottom: 5rem;
        }
    }

    .aspect-video-container {
        position: relative;
        width: 100%;
        aspect-ratio: 16 / 9;
    }

    #replayCanvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: transparent;
    }

    #replay-feedback {
        position: absolute;
        opacity: 0;
        transition: opacity 700ms ease-out;
        pointer-events: none;
        transform: translate(-50%, 49px);
    }

    .feedback-box {
        max-width: 28rem;
        padding: 1rem;
        background-color: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(4px);
        border: 1px solid var(--slate-200);
        border-radius: 1rem;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        pointer-events: auto;
    }

    .feedback-text {
        font-weight: 600;
        color: var(--slate-800);
    }

    /*
      ============================================
      CONTACT SECTION
      ============================================
    */
    .contact-links {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 1rem;
    }

    @media (min-width: 640px) {
        .contact-links {
            flex-direction: row;
            gap: 2rem;
        }
    }

    .email-link {
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: color 0.2s;
    }
    .email-link:hover { color: var(--thelo-blue); }

    .mb-4 { margin-bottom: 1rem; }

    /*
      ============================================
      FOOTER
      ============================================
    */
    footer {
        padding-top: 2.5rem;
        padding-bottom: 2.5rem;
        text-align: center;
        font-size: 0.875rem;
        color: var(--slate-500);
    }

    /*
      ============================================
      ANIMATIONS
      ============================================
    */
    .anim-target {
        opacity: 0;
        transition: opacity 0.7s cubic-bezier(0.215, 0.610, 0.355, 1), transform 0.7s cubic-bezier(0.215, 0.610, 0.355, 1);
        transform: translateY(20px);
    }
    .anim-target.is-visible { opacity: 1; transform: translateY(0); }

</style>
</head>

<body class="antialiased">

<nav id="mainNav">
    <div class="container-max nav-inner">
        <a href="/" class="logo">
            <img src="https://thelo.space/img/bluethelo.svg" alt="thelo logo" />
        </a>
        <div class="nav-links-desktop">
            <ul>
                <li><a href="#why" class="nav-link font-semibold" data-i18n="navWhy"></a></li>
                <li><a href="#thelopad" class="nav-link font-semibold" data-i18n="navThelopad"></a></li>
                <li><a href="#contact" class="nav-link font-semibold" data-i18n="navContact"></a></li>
                <li><a href="https://thelo.space/auth" class="nav-link font-semibold" data-i18n="navAuth"></a></li>
            </ul>
        </div>
        <div class="nav-controls">
             <div class="lang-switcher">
                  <!-- SUGGESTION: Convert these spans to buttons for accessibility -->
                  <span id="lang-en" class="lang-btn opacity-60" aria-label="Switch to English">EN</span>
                  <span class="divider">|</span>
                  <span id="lang-hy" class="lang-btn opacity-60" aria-label="Switch to Armenian">HY</span>
             </div>
            <button id="mobileMenuButton" class="mobile-menu-btn" aria-label="Toggle menu">
                <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <title>Toggle menu</title>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </div>
    </div>
    <div id="mobileMenu" class="hidden">
        <ul>
            <li><a href="#why" class="nav-link font-semibold" data-i18n="navWhy"></a></li>
            <li><a href="#thelopad" class="nav-link font-semibold" data-i18n="navThelopad"></a></li>
            <li><a href="https://thelo.space/auth" class="nav-link font-semibold" data-i18n="navAuth"></a></li>
            <li><a href="#contact" class="nav-link font-semibold" data-i18n="navContact"></a></li>
            <li><a href="https://thelo.space/satmathteam/" class="nav-link font-semibold" data-i18n="navJoin"></a></li>
        </ul>
    </div>
</nav>

    <!-- 
      ============================================
      UPDATED HERO SECTION
      ============================================
    -->
    <header>
        <div class="container-max">
            <div class="hero-grid">
                <div class="anim-target hero-text-container">
                    <h1 class="hero-title" data-i18n="heroTitle"> </h1>
                </div>
            </div>
            
            <div class="hero-img-container anim-target">
                <img src="https://thelo.space/img/thelo_people.png"
                     alt="A teacher helping a student use thelo on a computer and tablet"
                     style="width: 100%; height: auto; object-fit: contain;">
            </div>
        </div>
    </header>
    
    <!-- 
      ============================================
      NEW TEXT SECTION
      ============================================
    -->
    <section class="text-section">
        <div class="container-max">
            <div>
                <!-- Empty left column for spacing handled by margin auto in wrapper below -->
                
                <div class="anim-target text-content-wrapper">
                    <p class="text-xl font-semibold" data-i18n="heroP1"></p>
                    <p class="mt-4 text-xl text-slate-600" data-i18n="heroP2"></p>
                    <p class="mt-4 text-xl text-slate-600" data-i18n="heroP3"></p>
                </div>
            </div>
        </div>
    </section>

    <section id="why" class="section-padding">
    <div class="container-max">
        <div class="section-header anim-target">
            <h2 class="section-title font-bold" data-i18n="whyTitle"></h2>
        </div>
        <div class="window-container anim-target">
            <div class="feature-grid">
                <div>
                    <h3 class="text-xl font-bold" data-i18n="why1h"></h3>
                    <p class="mt-2 text-slate-600" data-i18n="why1p"></p>
                </div>
                <div>
                    <h3 class="text-xl font-bold" data-i18n="why2h"></h3>
                    <p class="mt-2 text-slate-600" data-i18n="why2p"></p>
                </div>
                <div>
                    <h3 class="text-xl font-bold" data-i18n="why3h"></h3>
                    <p class="mt-2 text-slate-600" data-i18n="why3p"></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="thelopad" class="section-padding">
    <div class="container-max">
        <div class="split-layout">
            <div class="anim-target" style="display: flex; flex-direction: column; justify-content: center;">
                <h2 class="section-title font-bold" data-i18n="thelopadTitle"></h2>
                <div class="pill-tag" data-i18n="thelopadTag"></div>
                <p class="mt-8 text-slate-600 text-lg" data-i18n="thelopadSub"></p>
            </div>
            <div class="anim-target" style="transition-delay: 0.2s;">
                <img id="laptopImage" src="https://thelo.space/img/theloLaptopEn.png" alt="A mockup of the thelopad tablet and a laptop showing thelo's interface" style="width: 100%; height: auto; object-fit: contain;">
            </div>
        </div>
    </div>
</section>

<section id="drawing-replay">
    <div class="container-max">
        <div class="aspect-video-container">
            <canvas id="replayCanvas"></canvas>
            <div id="replay-feedback">
                <div class="feedback-box">
                    <p class="feedback-text" data-i18n="replayFeedback"></p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="contact" class="section-padding">
    <div class="container-narrow" style="text-align: center;">
        <div class="anim-target">
            <h2 class="section-title font-bold" data-i18n="contactTitle"></h2>
            <p class="mt-8 text-lg text-slate-600" data-i18n="contactSub" style="margin-top: 1.5rem;"></p>
        </div>
        <div class="anim-target mt-8 text-slate-600" style="transition-delay: 0.1s;">
            <p class="mb-4" data-i18n="contactAlt"></p>
            <div class="contact-links">
                <a href="mailto:community.relations@thelo.space" class="email-link">
                    <i class="fas fa-envelope fa-fw"></i> <span>community.relations@thelo.space</span>
                </a>
            </div>
        </div>
        <div class="calendly-inline-widget anim-target" data-url="https://calendly.com/aramasatryan290/30min" style="min-width:320px; height:700px; transition-delay: 0.2s; margin-top: 3rem;"> </div>
        <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
    </div>
</section>

<footer>
    <p data-i18n="footer"></p>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    document.addEventListener('DOMContentLoaded', () => {

        let currentUser = null;
        let targetDashboard = null;

        const strings = {
            en: {
                title: 'thelo | AI Tutoring for Schools',
                navWhy: 'For Schools',
                navThelopad: 'How It Works',
                navAuth: 'Log in',
                navDash: 'Dashboard',
                navContact: 'Partner With Us',
                navJoin: 'Join',
                heroTitle: 'All for math <br><span class="text-blue-highlight">and math for all</span>',
                heroP1: 'thelo transforms your existing computer labs into interactive, AI-powered learning ecosystems.',
                heroP2: 'Using our unique tablet pair that connects to any computer, student handwriting is instantly digitized and analyzed, providing every student with a personal AI tutor for real-time, step-by-step guidance.',
                heroP3: 'Bridge the feedback gap, boost student outcomes, and bring world-class educational tools to your classrooms.',
                whyTitle: 'A Seamless Upgrade For Your School',
                why1h: 'Builds Mastery and Confidence',
                why1p: 'Our AI provides private, real-time feedback, allowing students to correct mistakes instantly and build the confidence to tackle complex problems.',
                why2h: 'Empowers True Differentiation',
                why2p: 'By automating step-by-step corrections, our AI co-pilot frees teachers from repetitive grading to focus on targeted, one-on-one student support.',
                why3h: 'Makes Learning Gaps Visible',
                why3p: 'We digitize the entire problem-solving process, not just the final answer, giving teachers the visibility to spot learning gaps early and intervene effectively.',
                thelopadTitle: 'Simple to Deploy, Powerful to Use.',
                thelopadTag: 'Built for the Classroom',
                thelopadSub: 'Setting up a thelo lab is straightforward. Our system integrates with your school\'s existing computers. We provide our unique tablet pairs that connect in minutes, turning any desk into an advanced learning station. No complex installations or special hardware required.',
                replayFeedback: 'That is the correct formula. Great work! üéâ',
                contactTitle: 'Partner With Us',
                contactSub: 'We are seeking forward-thinking schools, NGOs, and partners to bring the future of education to students across Armenia and beyond. Let\'s discuss how we can build a learning ecosystem together.',
                contactAlt: 'The best way to start is to schedule an introductory call or email us directly:',
                footer: '¬© 2025 thelo',
                laptopImageSrc: 'https://thelo.space/img/theloLaptopEn.png'
            },
            hy: {
                title: '‘π’•’¨’∏ | ‘±‘≤ ’∏÷Ç’Ω’∏÷Ç÷Å’∏÷Ç’¥ ’§’∫÷Ä’∏÷Å’∂’•÷Ä’´ ’∞’°’¥’°÷Ä',
                navWhy: '‘¥’∫÷Ä’∏÷Å’∂’•÷Ä',
                navThelopad: '‘ª’∂’π’∫’•’û’Ω ’ß ’°’∑’≠’°’ø’∏÷Ç’¥',
                navAuth: '’Ñ’∏÷Ç’ø÷Ñ',
                navDash: '’é’°’∞’°’∂’°’Ø',
                navContact: '‘¥’°÷Ä’±’•’õ÷Ñ ’£’∏÷Ä’Æ’®’∂’Ø’•÷Ä',
                navJoin: '’Ñ’´’°’∂’°’¨',
                heroTitle: '’Å’•÷Ä ’§’∫÷Ä’∏÷Å’®’ù<br><span class="text-blue-highlight">‘π’•’¨’∏’µ’´ ’∏÷Ç’Ω’∏÷Ç÷Å’¥’°’¥’¢</span>',
                heroP1: '‘π’•’¨’∏’∂ ’§’∫÷Ä’∏÷Å’∂’•÷Ä’´ ’∞’°’¥’°’Ø’°÷Ä’£’π’°’µ’´’∂ ’¨’Ω’°÷Ä’°’∂’∂’•÷Ä’´’∂ ’∞’∂’°÷Ä’°’æ’∏÷Ä’∏÷Ç’©’µ’∏÷Ç’∂ ’ß ’ø’°’¨’´’Ω ’§’°’º’∂’°’¨ ’´’∂’ø’•÷Ä’°’Ø’ø’´’æ, ’¥’°’©’•’¥’°’ø’´’Ø’°’Ø’°’∂ ’∏÷Ç’Ω’∏÷Ç÷Å’¥’°’∂ ’ß’Ø’∏’∞’°’¥’°’Ø’°÷Ä’£’•÷Ä’´÷â',
                heroP2: '’Ñ’•÷Ä ’µ’∏÷Ç÷Ä’°’∞’°’ø’∏÷Ç’Ø ’©’°’¢’¨’•’©’∂’•÷Ä’´ ’¶’∏÷Ç’µ’£’®, ’¥’´’°’∂’°’¨’∏’æ ÷Å’°’∂’Ø’°÷Å’°’Æ ’∞’°’¥’°’Ø’°÷Ä’£’π’´, ’°’∑’°’Ø’•÷Ä’ø’´ ’±’•’º’°’£’´÷Ä’∂ ’°’Ø’∂’©’°÷Ä’©’∏÷Ä’•’∂ ’©’æ’°’µ’∂’°÷Å’æ’∏÷Ç’¥ ’ß ÷á ’æ’•÷Ä’¨’∏÷Ç’Æ’∏÷Ç’¥’ù ’Ω’ø’∏÷Ç’£’•’¨’∏’æ ’∂÷Ä’° ’°’∑’≠’°’ø’°’∂÷Ñ’®÷â',
                heroP3: '’Ä’∂’°÷Ä’°’æ’∏÷Ä’∏÷Ç’©’µ’∏÷Ç’∂ ’®’∂’±’•’º’∂’•÷Ñ’õ ’±’•÷Ä ’§’∫÷Ä’∏÷Å’´ ’°’∑’°’Ø’•÷Ä’ø’∂’•÷Ä’´’∂ ’Ω’∏’æ’∏÷Ä’•’¨ ’¥’°’©’•’¥’°’ø’´’Ø’°’ù ’°’Ω’•’Ω ’§’° ’•÷Ä’¢’•÷Ñ ’°’æ’•’¨’´ ’°÷Ä’§’µ’∏÷Ç’∂’°’æ’•’ø ’π’´ ’•’≤’•’¨÷â',
                whyTitle: '’Ü’∏÷Ä’°÷Ä’°’Ø’°’∂ ’±’•’º÷Ñ’¢’•÷Ä’∏÷Ç’¥ ’±’•÷Ä ’§’∫÷Ä’∏÷Å’´ ’∞’°’¥’°÷Ä',
                why1h: '’ï’£’∂’∏÷Ç’¥ ’ß ’æ’°÷Ä’™’æ’•’¨',
                why1p: '’Ñ’•÷Ä ‘±‘≤÷ä’∂ ’ø÷Ä’°’¥’°’§÷Ä’∏÷Ç’¥ ’ß ’°’∂’∞’°’ø’°’Ø’°’∂ ’∏÷Ç’≤’≤’∏÷Ä’§’∏÷Ç’¥’ù ’©’∏÷Ç’µ’¨ ’ø’°’¨’∏’æ ’°’∑’°’Ø’•÷Ä’ø’∂’•÷Ä’´’∂ ’°’Ø’∂’©’°÷Ä’©’∏÷Ä’•’∂ ’∏÷Ç’≤’≤’•’¨ ’Ω’≠’°’¨’∂’•÷Ä’® ÷á ’±’•’º÷Ñ ’¢’•÷Ä’•’¨ ’¢’°÷Ä’§ ’≠’∂’§’´÷Ä’∂’•÷Ä ’¨’∏÷Ç’Æ’•’¨’∏÷Ç ’æ’Ω’ø’°’∞’∏÷Ç’©’µ’∏÷Ç’∂÷â',
                why2h: '’ç’ø’•’≤’Æ’∏÷Ç’¥ ’ß ’´÷Ä’°’Ø’°’∂ ’ø’°÷Ä’¢’•÷Ä’∏÷Ç’©’µ’∏÷Ç’∂',
                why2p: '‘±’æ’ø’∏’¥’°’ø’°÷Å’∂’•’¨’∏’æ ÷Ñ’°’µ’¨ ’°’º ÷Ñ’°’µ’¨ ’Ω’ø’∏÷Ç’£’∏÷Ç’¥’∂’•÷Ä’®’ù ’¥’•÷Ä ‘±‘≤ ÷Ö’£’∂’°’Ø’°’∂’® ’∏÷Ç’Ω’∏÷Ç÷Å’´’π’∂’•÷Ä’´’∂ ’°’¶’°’ø’∏÷Ç’¥ ’ß ’Ø’°÷Ä’¥’´÷Ä ’£÷Ä’π’´ ’°’∂’æ’•÷Ä’ª ’™’°’¥’•÷Ä’´÷Å’ù ’Ø’•’∂’ø÷Ä’∏’∂’°’∂’°’¨’∏÷Ç ’°’∑’°’Ø’•÷Ä’ø’∂’•÷Ä’´ ’°’∂’∞’°’ø’°’Ø’°’∂ ’°’ª’°’Ø÷Å’∏÷Ç’©’µ’°’∂ ’æ÷Ä’°÷â',
                why3h: '’è’•’Ω’°’∂’•’¨’´ ’ß ’§’°÷Ä’±’∂’∏÷Ç’¥ ’∏÷Ç’Ω’∏÷Ç’¥’∂’°’Ø’°’∂ ’¢’°÷Å’•÷Ä’®',
                why3p: '’Ñ’•’∂÷Ñ ’©’æ’°’µ’∂’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’≠’∂’§÷Ä’´ ’¨’∏÷Ç’Æ’¥’°’∂ ’∏’≤’ª ’£’∏÷Ä’Æ’®’∂’©’°÷Å’®, ’∏’π ’¥’´’°’µ’∂ ’∫’°’ø’°’Ω’≠’°’∂’®, ’´’∂’π’® ’∏÷Ç’Ω’∏÷Ç÷Å’´’π’∂’•÷Ä’´’∂ ’ø’°’¨’´’Ω ’ß ’ø’•’Ω’°’∂’•’¨’´’∏÷Ç’©’µ’∏÷Ç’∂’ù ’∏÷Ç’Ω’∏÷Ç’¥’∂’°’Ø’°’∂ ’¢’°÷Å’•÷Ä’® ’æ’°’≤ ’∂’Ø’°’ø’•’¨’∏÷Ç ÷á ’°÷Ä’§’µ’∏÷Ç’∂’°’æ’•’ø ’¥’´’ª’°’¥’ø’•’¨’∏÷Ç ’∞’°’¥’°÷Ä÷â',
                thelopadTitle: '’Ä’•’∑’ø ’ø’•’≤’°’Ø’°’µ’æ’∏’≤, ’°÷Ä’§’µ’∏÷Ç’∂’°’æ’•’ø ’Ø’´÷Ä’°’º’¥’°’¥’¢',
                thelopadTag: '‘¥’°’Ω’°÷Ä’°’∂’´ ’∞’°’¥’°÷Ä',
                thelopadSub: '‘π’•’¨’∏’¨’°’¢ ’Ω’ø’•’≤’Æ’•’¨’® ’∫’°÷Ä’¶ ’ß÷â ’Ñ’•÷Ä ’∞’°’¥’°’Ø’°÷Ä’£’® ’´’∂’ø’•’£÷Ä’æ’∏÷Ç’¥ ’ß ’±’•÷Ä ’§’∫÷Ä’∏÷Å’´ ’°’º’Ø’° ’∞’°’¥’°’Ø’°÷Ä’£’´’π’∂’•÷Ä’´’∂÷â ’Ñ’•’∂÷Ñ ’ø÷Ä’°’¥’°’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’¥’•÷Ä ’©’°’¢’¨’•’©’•’∂’•÷Ä’®, ’∏÷Ä’∏’∂÷Ñ ÷Ä’∏’∫’•’∂’•÷Ä’´ ’®’∂’©’°÷Å÷Ñ’∏÷Ç’¥ ÷Å’°’∂’Ø’°÷Å’°’Æ ’£÷Ä’°’Ω’•’≤’°’∂ ’æ’•÷Ä’°’Æ’∏÷Ç’¥ ’•’∂ ’°’º’°’ª’°’§’•’¥ ’∏÷Ç’Ω’∏÷Ç’¥’∂’°’Ø’°’∂ ’Ø’°’µ’°’∂’´÷â',
                replayFeedback: '‘¥’∏÷Ç ’≥’´’∑’ø ’•’Ω ÷Ö’£’ø’°’£’∏÷Ä’Æ’•’¨ ’¢’°’∂’°’±÷á’®÷â ‘±’∫÷Ä’•’ú’Ω',
                contactTitle: '‘¥’°÷Ä’±’•’õ÷Ñ ’¥’•÷Ä ’£’∏÷Ä’Æ’®’∂’Ø’•÷Ä’®',
                contactSub: '’Ñ’•’∂÷Ñ ÷É’∂’ø÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’°’º’°’ª’°’§’•’¥ ’§’∫÷Ä’∏÷Å’∂’•÷Ä ÷á ’∞’°’Ω’°÷Ä’°’Ø’°’Ø’°’∂ ’Ø’°’¶’¥’°’Ø’•÷Ä’∫’∏÷Ç’©’µ’∏÷Ç’∂’∂’•÷Ä’ù ’Ø÷Ä’©’∏÷Ç’©’µ’°’∂ ’°’∫’°’£’°’∂ ’Ä’°’µ’°’Ω’ø’°’∂’´ ÷á ’∂÷Ä’° ’Ω’°’∞’¥’°’∂’∂’•÷Ä’´÷Å ’§’∏÷Ç÷Ä’Ω ’£’ø’∂’æ’∏’≤ ’°’∑’°’Ø’•÷Ä’ø’∂’•÷Ä’´’∂ ’∞’°’Ω÷Å’∂’•’¨’∏÷Ç ’∞’°’¥’°÷Ä÷â ‘µ’Ø’•’õ÷Ñ ÷Ñ’∂’∂’°÷Ä’Ø’•’∂÷Ñ, ’©’• ’´’∂’π’∫’•’Ω ’Ø’°÷Ä’∏’≤ ’•’∂÷Ñ ’¥’´’°’Ω’´’∂ ’Ø’°’º’∏÷Ç÷Å’•’¨ ’∏÷Ç’Ω’∏÷Ç’¥’∂’°’Ø’°’∂ ’ß’Ø’∏’∞’°’¥’°’Ø’°÷Ä’£’•÷Ä÷â',
                contactAlt: '‘º’°’æ’°’£’∏÷Ç’µn ’¥’´’ª’∏÷Å’®’ù ’∂’°’≠’°’∫’•’Ω ’¶’°’∂’£’°’∞’°÷Ä’•’¨’®’ù ’Ø’°’¥ ’¥’•’¶ ’∏÷Ç’≤’≤’°’Ø’´’∏÷Ä’•’∂ ’∂’°’¥’°’Ø ’£÷Ä’•’¨’∂ ’ß÷â',
                footer: '¬© 2025 thelo',
                laptopImageSrc: 'https://thelo.space/img/theloLaptopHy.png'
            }
        };

        let currentLang = localStorage.getItem('thelo-lang') || 'en';

        const laptopImage = document.getElementById('laptopImage');
        const langEnBtn = document.getElementById('lang-en');
        const langHyBtn = document.getElementById('lang-hy');

        // --- Active state class for lang buttons ---
        // Note: these classes are now defined in the CSS block above
        const activeLangClass = 'opacity-100';
        const inactiveLangClass = 'opacity-60';

        // --- MODIFY THIS FUNCTION DEFINITION ---
        function updateAuthUI(lang, targetDashboard) { // <-- Add targetDashboard argument
            const T = strings[lang];
            const loginAnchors = document.querySelectorAll('[data-i18n="navAuth"]');

            loginAnchors.forEach(anchor => {
                if (currentUser && targetDashboard) { // <-- Check for targetDashboard
                    // --- USE targetDashboard HERE ---
                    anchor.href = targetDashboard;
                    // --- END CHANGE ---
                    anchor.textContent = T.navDash;
                } else {
                    anchor.href = "/auth";
                    anchor.textContent = T.navAuth;
                }
            });
        }

       function applyContent(lang) {
            const T = strings[lang];
            if (!T) return;

            // Updates all text content based on the selected language
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.dataset.i18n;
                if (key !== 'navAuth' && T[key]) {
                    el.innerHTML = T[key];
                }
            });
            
            // Updates the laptop image source for the correct language
            if (laptopImage) { // Add check in case element doesn't exist
                laptopImage.src = T.laptopImageSrc;
            }
            
            // Sets the 'lang' attribute on the HTML tag for accessibility
            document.documentElement.lang = lang;
            
            // Toggles the active state on the language switcher buttons
            langEnBtn.classList.toggle(activeLangClass, lang === 'en');
            langEnBtn.classList.toggle(inactiveLangClass, lang !== 'en');
            langHyBtn.classList.toggle(activeLangClass, lang === 'hy');
            langHyBtn.classList.toggle(inactiveLangClass, lang !== 'hy');


            // Logic for Navbar Font Weight
            const navLinks = document.querySelectorAll('a.nav-link.font-semibold');
            navLinks.forEach(link => {
                if (lang === 'hy') {
                    link.style.fontWeight = '400'; // Apply REGULAR weight for Armenian
                } else {
                    link.style.fontWeight = '600'; // Revert to SEMIBOLD for English
                }
            });
            const heroTitleEl = document.querySelector('[data-i18n="heroTitle"]');
            if (heroTitleEl) {
                if (lang === 'en') {
                    // Use ExtraBold (800) for Manrope in English
                    heroTitleEl.style.fontWeight = '800'; 
                } else {
                    // You can set a different weight for Armenian here if needed
                    // For now, we'll keep it at ExtraBold as well
                    heroTitleEl.style.fontWeight = '800';
                }
            }

            // --- Logic for Feedback Message Width ---
            const replayFeedbackEl = document.getElementById('replay-feedback');
            if (replayFeedbackEl) {
                const innerFeedbackDiv = replayFeedbackEl.querySelector('div');

                if (lang === 'hy') {
                    // Set specific width for Armenian
                    if (innerFeedbackDiv) {
                        innerFeedbackDiv.style.maxWidth = 'none';
                        innerFeedbackDiv.style.width = '420px'; // Set to 500px
                    }
                } else {
                    // Revert to default for English
                    if (innerFeedbackDiv) {
                        innerFeedbackDiv.style.maxWidth = '';
                        innerFeedbackDiv.style.width = '';
                    }
                }
            }
            // --- END Logic ---
        }
        
        langEnBtn.addEventListener('click', () => {
            currentLang = 'en';
            localStorage.setItem('thelo-lang', currentLang);
            applyContent(currentLang);
            updateAuthUI(currentLang, targetDashboard); // <-- ADD THIS LINE
        });

        langHyBtn.addEventListener('click', () => {
            currentLang = 'hy';
            localStorage.setItem('thelo-lang', currentLang);
            applyContent(currentLang);
            updateAuthUI(currentLang, targetDashboard); // <-- ADD THIS LINE
        });

        const firebaseConfig = {
            apiKey: "AIzaSyAbnPpcIt88B0jIAoLUdC71zmQDvR_fdu8",
            authDomain: "physmathacademy-722b3.firebaseapp.com",
            projectId: "physmathacademy-722b3",
            storageBucket: "physmathacademy-722b3.appspot.com",
            appId: "1:1093640992262:web:35b1bf4d2364bcf745f587"
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        onAuthStateChanged(auth, async (user) => { // <-- Make the function async
            currentUser = user;

            if (currentUser) {
                // --- START MODIFICATION ---
                // User is logged in, check if they are a tutor or student
                console.log("User logged in:", currentUser.email); // Debugging line
                let isTutor = false;
                let isStudent = false;
                
                // Default target dashboard
                targetDashboard = "/sdashboard"; 

                try {
                    // Check tutors collection (using email as ID)
                    const tutorDocRef = doc(db, "tutors", currentUser.email);
                    const tutorDocSnap = await getDoc(tutorDocRef);
                    if (tutorDocSnap.exists()) {
                        console.log("User is a tutor."); // Debugging line
                        isTutor = true;
                        targetDashboard = "/tdashboard"; // Set target to tutor dashboard
                    } else {
                        // Optional: Check students collection if not a tutor (using UID as ID)
                        const studentDocRef = doc(db, "thelo-students", currentUser.uid);
                        const studentDocSnap = await getDoc(studentDocRef);
                        if (studentDocSnap.exists()) {
                            console.log("User is a student."); // Debugging line
                            isStudent = true;
                            targetDashboard = "/sdashboard"; // Explicitly set target
                        } else {
                             console.warn("User document not found in tutors or thelo-students. Defaulting to student dashboard."); // Debugging line
                             // targetDashboard remains "/sdashboard"
                        }
                    }

                    // Update the UI after checking Firestore
                    updateAuthUI(currentLang, targetDashboard);

                } catch (error) {
                    console.error("Error checking user role:", error);
                    // Fallback: update UI with default dashboard link in case of error
                    updateAuthUI(currentLang, targetDashboard);
                }
                // --- END MODIFICATION ---

            } else {
                // User is logged out, update UI normally
                targetDashboard = null; // <-- ADD THIS LINE
                updateAuthUI(currentLang, null); // Pass null when logged out
            }
        });

        const mobileMenuButton = document.getElementById('mobileMenuButton');
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        document.querySelectorAll('#mobileMenu a').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        const animationObserver = new IntersectionObserver((entries) => entries.forEach(entry => {
            if(entry.isIntersecting){ entry.target.classList.add('is-visible'); animationObserver.unobserve(entry.target); }
        }), { threshold: 0.1 });
        document.querySelectorAll('.anim-target').forEach(el => animationObserver.observe(el));

        // Drawing Replay Logic (no changes needed here)
        const setupDrawingReplay = () => {
            const canvas = document.getElementById('replayCanvas');
            const feedbackEl = document.getElementById('replay-feedback');
            if (!canvas || !feedbackEl) return;
            const ctx = canvas.getContext('2d');
            let drawingData = null;
            let animationFrameId = null;
            const devicePixelRatio = window.devicePixelRatio || 1;
            const resizeCanvas = () => {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width * devicePixelRatio;
                canvas.height = rect.height * devicePixelRatio;
                ctx.scale(devicePixelRatio, devicePixelRatio);
                if (drawingData) {
                    // Redraw the final frame if data is already loaded
                    renderDrawingAtTime(Infinity, drawingData, ctx, true);
                }
            };
            const renderDrawingAtTime = (targetTime, data, context, isRedraw = false) => {
                const canvasWidth = context.canvas.width / devicePixelRatio;
                const canvasHeight = context.canvas.height / devicePixelRatio;
                context.clearRect(0, 0, canvasWidth, canvasHeight);
                context.lineCap = 'round';
                context.lineJoin = 'round';

                // --- FIX: Calculate the initial delay (offset) ---
                // This finds the timestamp of the very first point to remove dead air at the start.
                // We only calculate this once and store it on the data object.
                if (data.strokes.length > 0 && data.offset === undefined) {
                    data.offset = data.strokes.reduce((min, s) => Math.min(min, s.startTime || 0), Infinity);
                }
                const offset = data.offset || 0;

                data.strokes.forEach(stroke => {
                    const strokeStartTime = (stroke.startTime || 0) - (isRedraw ? 0 : offset);
                    if (targetTime < strokeStartTime) return;
                    context.strokeStyle = stroke.color || 'var(--thelo-blue)';
                    context.lineWidth = stroke.lineWidth || 4;
                    context.beginPath();
                    let movedToFirstPoint = false;
                    for (let i = 0; i < stroke.points.length; i++) {
                        const point = stroke.points[i];
                        const pointTimeAbsolute = strokeStartTime + (point.timeOffset || 0);
                        if (pointTimeAbsolute > targetTime) break;
                        if (!movedToFirstPoint) {
                            context.moveTo(point.normX * canvasWidth, point.normY * canvasHeight);
                            movedToFirstPoint = true;
                        } else {
                            context.lineTo(point.normX * canvasWidth, point.normY * canvasHeight);
                        }
                    }
                    if (movedToFirstPoint) context.stroke();
                });
            };
            const startReplayAnimation = (data) => {
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                let startTime = 0;
                const totalDuration = data.strokes.reduce((max, s) => Math.max(max, s.endTime), 0) - (data.offset || 0);
                const animate = (timestamp) => {
                    if (!startTime) startTime = timestamp;
                    const elapsedTime = timestamp - startTime;
                    renderDrawingAtTime(elapsedTime, data, ctx);
                    if (elapsedTime < totalDuration + 200) { // Add a small buffer
                        animationFrameId = requestAnimationFrame(animate);
                    } else {
                        renderDrawingAtTime(Infinity, data, ctx);
                        animationFrameId = null;
                        setTimeout(() => {
                            try {
                                const container = canvas.parentElement;
                                const rect = container.getBoundingClientRect();
                                const lastStroke = data.strokes.reduce((a, b) => (a.endTime > b.endTime ? a : b));
                                const lastPt = lastStroke.points[lastStroke.points.length - 1];
                                const xPx = lastPt.normX * rect.width;
                                const yPx = lastPt.normY * rect.height;
                                feedbackEl.style.right = 'auto';
                                feedbackEl.style.bottom = 'auto';
                                feedbackEl.style.left = `${xPx}px`;
                                feedbackEl.style.top  = `${yPx}px`;
                                feedbackEl.classList.remove('opacity-0');
                                feedbackEl.classList.add('opacity-100');
                            } catch (e) { console.error('Could not place feedback:', e); feedbackEl.classList.remove('opacity-0'); feedbackEl.classList.add('opacity-100'); }
                        }, 500);
                    }
                };
                animationFrameId = requestAnimationFrame(animate);
            };
            const replayObserver = new IntersectionObserver(async (entries, observer) => {
                if (entries[0].isIntersecting) {
                    try {
                        const response = await fetch('https://thelo.space/lessons/drawings/main.json');
                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                        drawingData = await response.json();
                        resizeCanvas();
                        startReplayAnimation(drawingData);
                        observer.unobserve(canvas);
                    } catch (error) { console.error('Failed to load drawing data:', error); }
                }
            }, { threshold: 0.4 }); 
            replayObserver.observe(canvas);
            window.addEventListener('resize', resizeCanvas);
        };

        // Initial Load
        applyContent(currentLang);
        setupDrawingReplay();
    });
</script>

</body>
</html>
